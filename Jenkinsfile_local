node{
    stage('1. SCM Checkout'){
        sh "git clone https://github.com/Nguyen74/helloworld.git"
    }

    stage('2. Maven build'){
        sh "mvn clean package"
    }

    stage('3. Build Docker image'){
        sh "docker build -t nbpn123/nguyennguyen ."
    }

    stage('4. Remove container'){
        sh "docker rm -f web-hello"
    }

    stage('5. Deploy Docker image to Tomcat'){
        sh "docker run -p 23456:8080 -d --name web-hello nbpn123/nguyennguyen"
    }

    stage('6. Upload Docker to Docker repo'){
        sh "docker push nbpn123/nguyennguyen"
    }
}
